<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Profile · SmartSpend AI</title>
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>

<div class="profile-page">
    <div class="profile-card">

        <button href="/" class="profile-close" id="closeProfile">&times;</button>

        <h2>Your Profile</h2>


        <!-- FORM -->
        <form id="profileForm">

        <div class="avatar-upload">
            <img id="avatarPreview" src="/static/IMAGES/person_12259248.png">
            <input type="file" id="avatarInput" accept="image/*">
        </div>

            <label>Full Name</label>
            <input type="text" id="name" placeholder="Your name">
        

        
            <label>Email</label>
            <input type="email" id="email" placeholder="your@email.com">
        

        
            <label>Occupation</label>
            <input type="text" id="occupation" placeholder="Student / Analyst / Developer">
        
        <div>
            <button type="submit" id="profile-submit">Save Profile</button>
        </div>
        </form>

        <!-- SAVED INFO -->
        <div class="profile-summary" id="profileSummary" style="margin-top:22px;font-size:0.75rem;opacity:0.75">
            <strong>Saved Profile</strong>
            <div id="summaryContent">No profile saved yet.</div>
        </div>

    </div>
</div>

<script>
/* ------------------
   LOAD PROFILE
------------------ */
const storedProfile = JSON.parse(localStorage.getItem("profile")) || {};

const nameInput = document.getElementById("name");
const emailInput = document.getElementById("email");
const occupationInput = document.getElementById("occupation");
const avatarPreview = document.getElementById("avatarPreview");
const summaryContent = document.getElementById("summaryContent");

nameInput.value = storedProfile.name || "";
emailInput.value = storedProfile.email || "";
occupationInput.value = storedProfile.occupation || "";
if (storedProfile.avatar) avatarPreview.src = storedProfile.avatar;

updateSummary();

/* ------------------
   AVATAR UPLOAD
------------------ */
document.getElementById("avatarInput").addEventListener("change", e => {
    const reader = new FileReader();
    reader.onload = () => {
        avatarPreview.src = reader.result;
        storedProfile.avatar = reader.result;
        saveProfile();
    };
    reader.readAsDataURL(e.target.files[0]);
});

/* ------------------
   SAVE PROFILE
------------------ */
document.getElementById("profileForm").addEventListener("submit", e => {
    e.preventDefault();
    saveProfile();
    alert("Profile saved");
});

function saveProfile() {
    storedProfile.name = nameInput.value;
    storedProfile.email = emailInput.value;
    storedProfile.occupation = occupationInput.value;

    localStorage.setItem("profile", JSON.stringify(storedProfile));
    updateSummary();
}

/* ------------------
   SUMMARY VIEW
------------------ */
function updateSummary() {
    if (!storedProfile.name) {
        summaryContent.innerText = "No profile saved yet.";
        return;
    }

    summaryContent.innerHTML = `
        <div>Name: ${storedProfile.name}</div>
        <div>Email: ${storedProfile.email || "-"}</div>
        <div>Occupation: ${storedProfile.occupation || "-"}</div>
    `;
}
document.getElementById("closeProfile")?.addEventListener("click", () => {
    window.location.href = "/"; // or "/" if that’s your signed-in home
});
</script>

</body>
</html>
